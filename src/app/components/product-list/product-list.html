<section class="products-section">
  <div class="container">
    <h2>Nuestros Productos</h2>
    
    <div class="category-filters" *ngIf="!isLoading && products.length > 0">
      <button 
        (click)="filterByCategory('')" 
        [class.active]="!selectedCategory"
        class="category-btn">
        Todos
      </button>
      <button 
        *ngFor="let category of getCategories()"
        (click)="filterByCategory(category)" 
        [class.active]="selectedCategory === category"
        class="category-btn">
        {{ category }}
      </button>
    </div>
    
    <div *ngIf="isLoading" class="loading">
      <p>Cargando productos...</p>
    </div>

    <div *ngIf="!isLoading && filteredProducts.length === 0" class="no-products">
      <p *ngIf="searchTerm">No se encontraron productos para "{{ searchTerm }}"</p>
      <p *ngIf="selectedCategory && !searchTerm">No hay productos en la categoría seleccionada</p>
      <p *ngIf="!selectedCategory && !searchTerm">No hay productos disponibles</p>
    </div>

    <div *ngIf="!isLoading && filteredProducts.length > 0" class="products-grid">
      <div *ngFor="let product of filteredProducts" class="product-card">
       <div class="product-image">
  <img 
    *ngIf="product.imagen && product.imagen !== ''" 
    [src]="product.imagen" 
    [alt]="product.nombre"
    (error)="product.imagen = ''"
  >
  <div *ngIf="!product.imagen || product.imagen === ''" class="image-placeholder">
    {{ product.nombre.charAt(0) }}
  </div>
</div>
        <div class="product-info">
          <h3>{{ product.nombre }}</h3>
          <p class="price">${{ product.precio.toFixed(2) }}</p>
          <p class="category">{{ product.categoria }}</p>
          <p class="description">{{ product.descripcion }}</p>
          <div class="stock-status" [class.in-stock]="product.stock > 0" [class.low-stock]="product.stock > 0 && product.stock <= 5">
            {{ product.stock > 0 ? (product.stock <= 5 ? 'Últimas unidades' : 'En stock') : 'Agotado' }}
            <span *ngIf="product.stock > 0">({{ product.stock }})</span>
          </div>
          <div class="product-actions">
            <button 
              (click)="addToCart(product)" 
              [disabled]="product.stock === 0"
              class="btn-primary">
              Agregar al Carrito
            </button>
            <button 
              (click)="viewDetails(product.id)"
              class="btn-secondary">
              Ver detalles
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>